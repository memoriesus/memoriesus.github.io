---
post: page
title: 自动布局约束问题
tags: [iOS]
comment: true 
---

# AutoLayout 普遍的问题

在引擎盖下，自动布局引擎将每个约束作为计算视图位置和大小的公式读取。当自动布局引擎无法满足所有约束时，您将收到一个错误。
一般都有三种错误：
* 1， 逻辑错误：这些类型的错误通常发生在您无意中设置了不正确的约束时。也许你输入了错误的常量值，在元素之间选择了错误的关系，或者没有考虑不同的方向和屏幕大小。
针对逻辑错误，可以从如下方面进行检查
a，检查现有约束。确保没有遗漏任何约束或意外添加不需要的约束。确保所有约束都附加到正确的项和属性。
b，仔细检查图幅。确保没有意外拉伸或收缩。
对于具有不可见背景的视图（如标签或按钮），这一点尤为重要。当这些项目意外调整大小时，这可能并不明显。
调整大小的一个症状是基线对齐的视图不再正确对齐。这是因为基线对齐仅在视图以其固有内容高度显示时才起作用。如果垂直拉伸或收缩视图，文本会神秘地出现在错误的位置。
如果控件应该始终匹配其内部内容大小，请为其赋予非常高的内容拥抱和抗压缩优先级（例如，999）。
查找您对布局所做的任何假设，并添加明确的约束以确保这些假设是真实的。
记住，不满意的布局通常是最容易发现和修复的问题。添加其他约束，直到出现冲突，然后检查并修复冲突。
试着理解为什么给定的约束会产生你所看到的结果。如果你理解它，你就可以很好地解决它了。
尝试替代约束。自动布局通常为同一问题提供多种不同的解决方案。尝试不同的方法可以解决问题，或者至少可以更容易地发现错误。
* 2，不可满足的约束：当自动布局引擎无法计算解决方案时，您将得到这些错误。一个简单的例子是将一个视图设置为宽度<20且宽度=100。因为这两个约束不能同时为真，所以您将得到一个错误。
当系统检查出不满足的约束的时候，会做如下事情：
1，自动布局标识冲突约束集。
2，它会打破其中一个冲突约束并检查布局。系统将继续打破约束，直到找到有效的布局。
3，自动布局将有关冲突和断开的约束的信息记录到控制台。
这个后备系统允许应用程序继续运行，同时仍然尝试向用户呈现有意义的内容。但是，打破约束的效果可能因布局而异，甚至因构建而异。
针对这样的错误，一旦知道错误，解决方案通常非常简单。移除其中一个约束，或将其更改为可选约束。
当程序化添加视图到视图层级时候，会发生不满足的约束问题
当你程序化创建布局你的视图时候， 你需要设置translatesAutoresizingMaskIntoConstraints 为NO
当视图层次显示在对其来说太小的空间中时，经常会出现不可满足的约束。
* 3，不明确的约束：当自动布局引擎试图满足多个约束，并且存在多个可能的解决方案时，您将得到这种类型的错误。当这种情况发生时，引擎将随机选择一个解决方案，这可能会对您的UI产生意外的结果。

使用Symbolic breakpoint来发现不满足的约束
1，创建一个symbolic 断点
UIViewAlertForUnsatisfiableConstraints

当自动布局引擎为一个约束系统找到多个解决方案时，您将得到一个被称为模糊布局的东西。
使用UIView debug方法
UIView有有四个有用的方法去调试你的约束问题：
* hasAmbiguousLayout:在放错位置的视图上调用此方法。如果视图的框架不明确，则返回YES。否则，它返回NO。
* exerciseAmbiguityInLayout：它将视图布局随机更改为其他有效布局。使UI来回跳转有助于找出缺少约束的位置。
* exerciseAmbiguityInLayout：它返回沿指定方向影响该视图的所有约束的数组。
* _autolayoutTrace:它返回一个字符串，其中包含有关包含该视图的整个视图层次结构的诊断信息。


启动storyboard通过interface builder
打开general setting。设置Main Interface就可以了
启动storyboard通过代码

* 1， 使用storyboard名字初始化storyboard
`let storyboard = UIStoryboard(name:"TabBar", bundle:nil)`
* 2,创建一个引用到storyboard的初始化试图控制器
* 3，设置AppDelegate的window-通过设备的尺寸作为frame
* 4，设置window的根视图控制器作为初始化器
* 5，调用 makeKeyAndVisible
当你使用storyboard时候，appdelegeate的window熟悉是自动配置的，当你使用代码的时候你需要做更多的手动工作


